function initSearch(){getParameterByName("query")&&(query=decodeURIComponent(getParameterByName("query")),searchInput.value=query,execSearch(query)),query=searchInput.value,searchContainer&&searchForm.addEventListener?searchForm.addEventListener("submit",submitCallback,!1):searchContainer&&searchForm.attachEvent&&searchForm.attachEvent("onsubmit",submitCallback)}function submitCallback(event){event.preventDefault(),query=searchInput.value,query.length>=2&&query.length<=30?execSearch(query):resultsMeta.innerHTML="Your search query must be 2â€“30 characters in length."}function execSearch(query){(""!=query||allowEmpty)&&getSearchResults()}function getSearchResults(){var request=new XMLHttpRequest;request.open("GET",jsonFeedUrl,!0),request.onload=function(){if(request.status>=200&&request.status<400){var data=JSON.parse(request.responseText);processData(data)}},request.onerror=function(){},request.send()}function processData(data){for(var item,titleCheck,ledeCheck,contentCheck,categoriesCheck,tagsCheck,resultsCount=0,results="",index=0;index<data.length;index++)switch(item=data[index],queryFormatted=query.toLowerCase(),titleCheck=item.title.toLowerCase().indexOf(queryFormatted)>-1,ledeCheck=!1,contentCheck=!1,categoriesCheck=!1,tagsCheck=!1,item.lede&&(ledeCheck=item.lede.toLowerCase().indexOf(queryFormatted)>-1),item.content&&(contentCheck=item.content.toLowerCase().indexOf(queryFormatted)>-1),item.categories&&(categoriesCheck=item.categories.toLowerCase().indexOf(queryFormatted)>-1),item.tags&&(tagsCheck=item.tags.toLowerCase().indexOf(queryFormatted)>-1),item.type){case"page":(titleCheck||ledeCheck||contentCheck)&&(resultsCount++,results+=populateResultContent(resultTemplatePage.innerHTML,item));break;case"article":(titleCheck||ledeCheck||contentCheck||categoriesCheck||tagsCheck)&&(resultsCount++,results+=populateResultContent(resultTemplateArticle.innerHTML,item));break;case"pen":(titleCheck||ledeCheck||contentCheck||categoriesCheck||tagsCheck)&&(resultsCount++,results+=populateResultContent(resultTemplatePen.innerHTML,item))}populateResultsString(resultsCount),showSearchResults(results),ga("send","event","search",resultsCount,query)}function showSearchResults(results){resultsList.innerHTML=results,document.activeElement.blur(),resultsMeta.scrollIntoView()}function populateResultContent(html,item){return html=injectContent(html,item.link,"@@url@@"),html=injectContent(html,item.title,"@@title@@"),html=injectContent(html,item.date,"@@date@@"),html=injectContent(html,item.date_friendly,"@@date_friendly@@"),item.lede?html=injectContent(html,item.lede,"@@lede@@"):"pen"==item.type&&(html=injectContent(html,"<em>Featured Pen</em>","@@lede@@")),html}function populateResultsString(count){var resultSuffix=1==count?"":"s",searchMeta="<strong>"+count+"</strong> result"+resultSuffix+" found for <q>"+query+"</q>";resultsMeta.innerHTML=searchMeta}function getParameterByName(name){var match=RegExp("[?&]"+name+"=([^&]*)").exec(window.location.search);return match&&decodeURIComponent(match[1].replace(/\+/g," "))}function injectContent(originalContent,injection,placeholder){var regex=new RegExp(placeholder,"g");return originalContent.replace(regex,injection)}var query,queryFormatted,jsonFeedUrl="../search.json",searchContainer=document.querySelector("#search"),searchForm=document.querySelector("#search-form"),searchInput=document.querySelector("#search-input"),searchSubmit=document.querySelector("#search-submit"),resultsMeta=document.querySelector("#search-meta"),resultsList=document.querySelector("#search-results-list"),resultTemplatePage=document.querySelector("#search-template-page"),resultTemplateArticle=document.querySelector("#search-template-article"),resultTemplatePen=document.querySelector("#search-template-pen"),allowEmpty=!1;initSearch(),searchInput.disabled=!1,searchSubmit.disabled=!1;