function initSearch(){getParameterByName("query")&&(query=decodeURIComponent(getParameterByName("query")).toLowerCase(),searchInput.value=query,execSearch(query)),query=searchInput.value,searchContainer&&searchForm.addEventListener?searchForm.addEventListener("submit",submitCallback,!1):searchContainer&&searchForm.attachEvent&&searchForm.attachEvent("onsubmit",submitCallback)}function submitCallback(event){event.preventDefault(),query=searchInput.value,query.length>=2&&query.length<=30?execSearch(query):resultsMeta.innerHTML="Your search query must be 2â€“30 characters in length."}function execSearch(query){(""!=query||allowEmpty)&&getSearchResults()}function getSearchResults(){var request=new XMLHttpRequest;request.open("GET",jsonFeedUrl,!0),request.onload=function(){if(request.status>=200&&request.status<400){var data=JSON.parse(request.responseText);processData(data)}},request.onerror=function(){},request.send()}function processData(data){for(var item,titleCheck,introductionCheck,contentCheck,categoriesCheck,tagsCheck,resultsCount=0,results="",index=0;index<data.length;index++)switch(item=data[index],query=query.toLowerCase(),titleCheck=item.title.toLowerCase().indexOf(query)>-1,introductionCheck=!1,contentCheck=!1,categoriesCheck=!1,tagsCheck=!1,item.introduction&&(introductionCheck=item.introduction.toLowerCase().indexOf(query)>-1),item.content&&(contentCheck=item.content.toLowerCase().indexOf(query)>-1),item.categories&&(categoriesCheck=item.categories.toLowerCase().indexOf(query)>-1),item.tags&&(tagsCheck=item.tags.toLowerCase().indexOf(query)>-1),item.type){case"page":(titleCheck||introductionCheck||contentCheck)&&(resultsCount++,results+=populateResultContent(resultTemplatePage.innerHTML,item));break;case"article":(titleCheck||introductionCheck||contentCheck||categoriesCheck||tagsCheck)&&(resultsCount++,results+=populateResultContent(resultTemplateArticle.innerHTML,item));break;case"pen":(titleCheck||introductionCheck||contentCheck||categoriesCheck||tagsCheck)&&(resultsCount++,results+=populateResultContent(resultTemplatePen.innerHTML,item))}populateResultsString(resultsCount),showSearchResults(results)}function showSearchResults(results){resultsList.innerHTML=results}function populateResultContent(html,item){return html=injectContent(html,item.link,"@@url@@"),html=injectContent(html,item.title,"@@title@@"),html=injectContent(html,item.date,"@@date@@"),html=injectContent(html,item.date_friendly,"@@date_friendly@@"),item.introduction?html=injectContent(html,item.introduction,"@@introduction@@"):"pen"==item.type&&(html=injectContent(html,"<em>Featured Pen</em>","@@introduction@@")),html}function populateResultsString(count){var resultSuffix=1==count?"s":"",searchMeta="<em>"+count+"</em> result"+resultSuffix+" found for <q>"+query.toLowerCase()+"</q>";resultsMeta.innerHTML=searchMeta}function getParameterByName(name){var match=RegExp("[?&]"+name+"=([^&]*)").exec(window.location.search);return match&&decodeURIComponent(match[1].replace(/\+/g," "))}function injectContent(originalContent,injection,placeholder){var regex=new RegExp(placeholder,"g");return originalContent.replace(regex,injection)}var query,jsonFeedUrl="../search.json",searchContainer=document.getElementById("search"),searchForm=document.getElementById("search-form"),searchInput=document.getElementById("search-input"),searchSubmit=document.getElementById("search-submit"),resultsMeta=document.getElementById("search-meta"),resultsList=document.getElementById("search-results-list"),resultTemplatePage=document.getElementById("search-template-page"),resultTemplateArticle=document.getElementById("search-template-article"),resultTemplatePen=document.getElementById("search-template-pen"),allowEmpty=!1;initSearch(),searchInput.disabled=!1,searchSubmit.disabled=!1;