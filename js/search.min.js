function initSearch(){getParameterByName("query")&&(query=decodeURIComponent(getParameterByName("query")),searchInput.value=query,execSearch(query)),query=searchInput.value,resultsContainer&&searchForm.addEventListener?searchForm.addEventListener("submit",submitCallback,!1):resultsContainer&&searchForm.attachEvent&&searchForm.attachEvent("onsubmit",submitCallback)}function submitCallback(e){e.preventDefault(),query=searchInput.value,execSearch(query)}function execSearch(e){(""!=e||allowEmpty)&&getSearchResults()}function getSearchResults(){var e=new XMLHttpRequest;e.open("GET",jsonFeedUrl,!0),e.onload=function(){if(e.status>=200&&e.status<400){var t=JSON.parse(e.responseText);processData(t)}},e.onerror=function(){},e.send()}function processData(e){a=[];for(var t=0,a="",n=0;n<e.length;n++){var r=e[n];if(r.title.toLowerCase().indexOf(query.toLowerCase())>-1||r.content.toLowerCase().indexOf(query.toLowerCase())>-1||r.introduction.toLowerCase().indexOf(query.toLowerCase())>-1||r.categories.toLowerCase().indexOf(query.toLowerCase())>-1||r.tags.toLowerCase().indexOf(query.toLowerCase())>-1){if(r.categories)if(r.categories.toLowerCase().indexOf("article")>-1)var s=populateResultContent(resultTemplateArticle.innerHTML,r);else var s=populateResultContent(resultTemplatePen.innerHTML,r);else var s=populateResultContent(resultTemplatePage.innerHTML,r);t++,a+=s}}populateResultsString(t),showSearchResults(a)}function showSearchResults(e){resultsList.innerHTML=e}function populateResultContent(e,t){return e=injectContent(e,t.link,"@@url@@"),e=injectContent(e,t.title,"@@title@@"),e=injectContent(e,t.date,"@@date@@"),e=injectContent(e,t.date_friendly,"@@date_friendly@@"),e=injectContent(e,t.introduction,"@@introduction@@")}function populateResultsString(e){var t=e>1?"s":"",a="<em>"+e+"</em> result"+t+" found for <q>"+query+"</q>";resultsMeta.innerHTML=a}function getParameterByName(e){var t=RegExp("[?&]"+e+"=([^&]*)").exec(window.location.search);return t&&decodeURIComponent(t[1].replace(/\+/g," "))}function injectContent(e,t,a){var n=new RegExp(a,"g");return e.replace(n,t)}var query,jsonFeedUrl="../feed.json",searchForm=document.getElementsByClassName("search-form")[0],searchInput=document.getElementsByClassName("search-input")[0],searchSubmit=document.getElementsByClassName("search-submit")[0],resultTemplateArticle=document.getElementsByClassName("search-template-article")[0],resultTemplatePen=document.getElementsByClassName("search-template-pen")[0],resultTemplatePage=document.getElementsByClassName("search-template-page")[0],resultsContainer=document.getElementsByClassName("main-search")[0],resultsMeta=document.getElementsByClassName("search-meta")[0],resultsList=document.getElementsByClassName("search-results-list")[0],allowEmpty=!1;initSearch(),searchInput.disabled=!1,searchSubmit.disabled=!1;